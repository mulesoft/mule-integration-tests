<?xml version="1.0" encoding="UTF-8"?>
<mule xmlns="http://www.mulesoft.org/schema/mule/core"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xmlns:validation="http://www.mulesoft.org/schema/mule/validation"
      xmlns:test="http://www.mulesoft.org/schema/mule/test"
      xsi:schemaLocation="
        http://www.mulesoft.org/schema/mule/validation http://www.mulesoft.org/schema/mule/validation/current/mule-validation.xsd
        http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
        http://www.mulesoft.org/schema/mule/test http://www.mulesoft.org/schema/mule/test/current/mule-test.xsd">

    <flow name="test-router">
        <first-successful>
            <processor-chain>
                <validation:is-true expression="#[payload is String]"/>
                <test:processor appendString=" is a string"/>
            </processor-chain>
            <processor-chain>
                <validation:is-true expression="#[payload is Number]"/>
                <test:processor appendString=" is a number"/>
            </processor-chain>
        </first-successful>
    </flow>

    <flow name="withExpression">
        <first-successful failureExpression="#[payload contains 'is a number']">
            <test:processor appendString=" is a number" />
            <test:processor appendString=" is a string" />
        </first-successful>
    </flow>

    <flow name="withExpressionAllFail">
        <first-successful failureExpression="#[payload contains 'is a ']">
            <test:processor appendString=" is a number" />
            <test:processor appendString=" is a string" />
        </first-successful>
    </flow>

    <flow name="withOneWayEndpoints">
        <first-successful>
            <test:processor throwException="true"/>
            <flow-ref name="withOneWayEndpoints-handler"/>
        </first-successful>
    </flow>

    <flow name="withOneWayEndpoints-handler">
        <test:queue name="WithOneWayEndpoints.out"/>
    </flow>
</mule>
